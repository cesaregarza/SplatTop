# Production values for splattop.
# This file contains production-specific overrides for the default values.yaml
# Use with: helm install splattop ./helm/splattop -f ./helm/splattop/values-prod.yaml

# Global configuration
global:
  environment: production

# FastAPI backend configuration
fastapi:
  replicas: 2
  env:
    COMP_LEADERBOARD_ENABLED: "true"

# React frontend configuration
react:
  replicas: 2

# Celery worker configuration
celeryWorker:
  env:
    COMP_LEADERBOARD_ENABLED: "true"

# Celery beat configuration
celeryBeat:
  env:
    COMP_LEADERBOARD_ENABLED: "true"

# Ingress configuration
ingress:
  enabled: true
  hosts:
    - host: splat.top
      paths:
        - path: /.well-known/
          pathType: Prefix
          serviceName: fastapi
          serviceNameOverride: fast-api-app-service
          servicePort: 8000
        - path: /api
          pathType: Prefix
          serviceName: fastapi
          serviceNameOverride: fast-api-app-service
          servicePort: 8000
        - path: /ws
          pathType: Prefix
          serviceName: fastapi
          serviceNameOverride: fast-api-app-service
          servicePort: 8001
        - path: /
          pathType: Prefix
          serviceName: react
          serviceNameOverride: react-app-service
          servicePort: 80
    - host: comp.splat.top
      paths:
        - path: /.well-known/
          pathType: Prefix
          serviceName: fastapi
          serviceNameOverride: fast-api-app-service
          servicePort: 8000
        - path: /api
          pathType: Prefix
          serviceName: fastapi
          serviceNameOverride: fast-api-app-service
          servicePort: 8000
        - path: /ws
          pathType: Prefix
          serviceName: fastapi
          serviceNameOverride: fast-api-app-service
          servicePort: 8001
        - path: /
          pathType: Prefix
          serviceName: react
          serviceNameOverride: react-app-service
          servicePort: 80
  tls:
    enabled: true
    secretName: tls-secret
    certificate:
      enabled: true

# Monitoring stack configuration (enabled in production)
monitoring:
  cilium:
    prometheusEgressKubeAPI:
      enabled: true
  prometheus:
    enabled: true
    rules:
      enabled: true
  grafana:
    enabled: true
    serverDomain: grafana.splat.top
    serverRootUrl: https://grafana.splat.top/
    ingress:
      enabled: true
      annotations:
        cert-manager.io/cluster-issuer: letsencrypt-prod
        nginx.ingress.kubernetes.io/ssl-redirect: "false"
      hosts:
        - host: grafana.splat.top
          paths:
            - path: /
              pathType: Prefix
              serviceName: grafana
              servicePort: 80
              serviceNameOverride: grafana
      tls:
        enabled: true
        secretName: grafana-tls
    datasourcesConfigMapName: grafana-datasources
    dashboardProvidersConfigMapName: grafana-dashboard-providers
    dashboards:
      - name: core
        configMapName: grafana-dashboard-core
      - name: splatgpt
        configMapName: grafana-dashboard-splatgpt
      - name: auth-rate
        configMapName: grafana-dashboard-auth-rate
      - name: realtime
        configMapName: grafana-dashboard-realtime
      - name: ripple
        configMapName: grafana-dashboard-ripple
      - name: api-usage
        configMapName: grafana-dashboard-api-usage
      - name: data-pipeline
        configMapName: grafana-dashboard-data-pipeline
  alertmanager:
    enabled: true
