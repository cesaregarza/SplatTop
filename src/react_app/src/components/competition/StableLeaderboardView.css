.grade-badge,
.grade-chip {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: 8px;
  --radius: 8px;
  border: 1px solid rgba(255, 255, 255, 0.08);
  color: #e6e6f0;
  background: #0f172a; /* slate-900 */
  z-index: 0;
  min-width: 3.25rem;
  font-family: var(--font-data, "FiraMono", monospace);
}

.grade-badge {
  padding: 2px 8px;
  font-weight: 600;
  font-size: 12px;
  line-height: 1.25;
}

.grade-chip {
  padding: 6px 12px;
  font-weight: 600;
  font-size: 0.85rem;
  transition: transform 150ms ease;
  min-width: 3.5rem;
}
.grade-chip:hover { transform: scale(1.05); }
.grade-chip.is-active { transform: scale(1.02); }

.xxstar-score {
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 0.2rem;
  --ring-pad: 4px;
  color: #fde68a;
  font-family: var(--font-data, "FiraMono", monospace);
  text-shadow: 0 0 6px rgba(249, 168, 212, 0.55), 0 0 12px rgba(91, 33, 182, 0.3);
}

.xxstar-score::after {
  content: "";
  position: absolute;
  inset: -0.2rem -0.35rem;
  border-radius: 1rem;
  background: radial-gradient(circle at 50% 50%, rgba(250, 232, 255, 0.35) 0%, rgba(244, 114, 182, 0.22) 48%, rgba(59, 7, 100, 0.18) 70%, transparent 100%);
  opacity: 0.55;
  pointer-events: none;
  filter: blur(1.4px);
  animation: xxScorePulse 4200ms ease-in-out infinite;
  z-index: -1;
}

.xxstar-scorebar {
  position: relative;
  box-shadow: 0 0 0 1px rgba(249, 168, 212, 0.28);
  background: linear-gradient(90deg, rgba(249, 168, 212, 0.32), rgba(196, 181, 253, 0.24));
}

.xxstar-scorebar::after {
  content: "";
  position: absolute;
  inset: -3px;
  border-radius: inherit;
  background: radial-gradient(circle at 25% 50%, rgba(252, 231, 243, 0.38) 0%, transparent 55%),
              radial-gradient(circle at 75% 50%, rgba(233, 213, 255, 0.32) 0%, transparent 55%);
  opacity: 0.55;
  filter: blur(5px);
  pointer-events: none;
}

/* Top tiers — strong visual presence */
.grade-badge.grade-tier-xxstar,
.grade-chip.grade-tier-xxstar {
  background: linear-gradient(135deg, rgba(217,70,239,0.22), rgba(244,63,94,0.22));
  color: #fde2f2;
  border-color: rgba(217,70,239,0.45);
  box-shadow: 0 0 0 2px rgba(217,70,239,0.24) inset,
              0 0 12px rgba(244,114,182,0.45),
              0 0 22px rgba(244,114,182,0.25);
}

.grade-badge.grade-tier-xxplus,
.grade-chip.grade-tier-xxplus {
  background: linear-gradient(135deg, rgba(217,70,239,0.18), rgba(236,72,153,0.18));
  color: #f6e7fb;
  border-color: rgba(217,70,239,0.35);
  box-shadow: 0 0 0 2px rgba(217,70,239,0.18) inset,
              0 0 10px rgba(217,70,239,0.4),
              0 0 20px rgba(217,70,239,0.22);
}

.grade-badge.grade-tier-xx,
.grade-chip.grade-tier-xx {
  background: linear-gradient(135deg, rgba(217,70,239,0.12), rgba(236,72,153,0.12));
  color: #f3e8ff;
  border-color: rgba(217,70,239,0.28);
  box-shadow: 0 0 0 2px rgba(217,70,239,0.12) inset,
              0 0 8px rgba(217,70,239,0.35);
}

/* XS tier — subtle static glow, no animation for perf */
.grade-badge.grade-tier-xsplus,
.grade-chip.grade-tier-xsplus {
  background: linear-gradient(135deg, rgba(139,92,246,0.22), rgba(99,102,241,0.22));
  color: #ede9fe;
  border-color: rgba(139,92,246,0.28);
  box-shadow: 0 0 10px rgba(139,92,246,0.38), 0 0 18px rgba(99,102,241,0.25);
  filter: drop-shadow(0 0 6px rgba(139,92,246,0.25));
}
.grade-badge.grade-tier-xs,
.grade-chip.grade-tier-xs {
  background: linear-gradient(135deg, rgba(139,92,246,0.18), rgba(99,102,241,0.18));
  color: #e9d5ff;
  border-color: rgba(139,92,246,0.24);
  box-shadow: 0 0 9px rgba(139,92,246,0.32), 0 0 16px rgba(99,102,241,0.22);
  filter: drop-shadow(0 0 5px rgba(139,92,246,0.22));
}
.grade-badge.grade-tier-xsminus,
.grade-chip.grade-tier-xsminus {
  background: linear-gradient(135deg, rgba(139,92,246,0.14), rgba(99,102,241,0.14));
  color: #e9d5ff;
  border-color: rgba(139,92,246,0.2);
  box-shadow: 0 0 8px rgba(139,92,246,0.26), 0 0 14px rgba(99,102,241,0.18);
  filter: drop-shadow(0 0 4px rgba(139,92,246,0.18));
}

/* Other grades — minimal styling */
.grade-badge.grade-tier-xaplus,
.grade-chip.grade-tier-xaplus { background: rgba(56,189,248,0.18); color: #cffafe; border-color: rgba(56,189,248,0.25); }
.grade-badge.grade-tier-xa,
.grade-chip.grade-tier-xa { background: rgba(56,189,248,0.14); color: #e0f2fe; border-color: rgba(56,189,248,0.18); }
.grade-badge.grade-tier-xaminus,
.grade-chip.grade-tier-xaminus { background: rgba(56,189,248,0.10); color: #e0f2fe; border-color: rgba(56,189,248,0.14); }
.grade-badge.grade-tier-xbplus,
.grade-chip.grade-tier-xbplus { background: rgba(100,116,139,0.20); color: #e2e8f0; border-color: rgba(148,163,184,0.20); }
.grade-badge.grade-tier-xb,
.grade-chip.grade-tier-xb { background: rgba(100,116,139,0.16); color: #e2e8f0; border-color: rgba(148,163,184,0.18); }
.grade-badge.grade-tier-xbminus,
.grade-chip.grade-tier-xbminus { background: rgba(100,116,139,0.12); color: #e2e8f0; border-color: rgba(148,163,184,0.14); }
.grade-badge.grade-tier-default,
.grade-chip.grade-tier-default { background: rgba(51,65,85,0.4); color: #e5e7eb; border-color: rgba(255,255,255,0.08); }

/* Electric crackling ring for XX tiers (one ::before element; transforms only) */
.grade-badge.grade-tier-xxstar::before,
.grade-chip.grade-tier-xxstar::before,
.grade-badge.grade-tier-xxplus::before,
.grade-chip.grade-tier-xxplus::before,
.grade-badge.grade-tier-xx::before,
.grade-chip.grade-tier-xx::before{ content: none; }

.grade-badge.grade-tier-xxstar::after,
.grade-chip.grade-tier-xxstar::after,
.grade-badge.grade-tier-xxplus::after,
.grade-chip.grade-tier-xxplus::after {
  content: "";
  position: absolute;
  inset: -9px;
  border-radius: 16px;
  background: radial-gradient(circle at center,
      rgba(253, 216, 222, 0.42) 0%,
      rgba(236, 72, 153, 0.28) 36%,
      rgba(67, 34, 137, 0.14) 64%,
      transparent 100%);
  opacity: 0.6;
  pointer-events: none;
  z-index: -1;
  mix-blend-mode: screen;
  filter: blur(1.5px);
  animation: xxPulse 5200ms ease-in-out infinite;
}

.grade-badge.grade-tier-xxplus::after,
.grade-chip.grade-tier-xxplus::after {
  inset: -8px;
  background: radial-gradient(circle at center,
      rgba(236, 206, 255, 0.38) 0%,
      rgba(196, 98, 255, 0.24) 36%,
      rgba(59, 28, 112, 0.12) 62%,
      transparent 100%);
  opacity: 0.55;
}

/* removed elec-flicker/jitter ring animations in favor of JS crackle paths */

@media (prefers-reduced-motion: reduce) {
  .grade-badge.grade-tier-xxstar::before,
  .grade-chip.grade-tier-xxstar::before,
  .grade-badge.grade-tier-xxplus::before,
  .grade-chip.grade-tier-xxplus::before,
  .grade-badge.grade-tier-xx::before,
  .grade-chip.grade-tier-xx::before { animation: none; opacity: .9; }
  .grade-badge.grade-tier-xxstar::after,
  .grade-chip.grade-tier-xxstar::after,
  .grade-badge.grade-tier-xxplus::after,
  .grade-chip.grade-tier-xxplus::after {
    animation: none;
    opacity: 0.7;
  }
  .xxstar-score {
    animation: none;
  }
  .xxstar-score::after {
    animation: none;
    opacity: 0.65;
  }
  .xxstar-scorebar {
    animation: none;
  }
  .xxstar-scorebar::after {
    animation: none;
    opacity: 0.6;
  }
}

/* Electric ring tunables */
:root{
  --zap-color: #a78bfa;
  --ring: 6px;
  --zap-cycle-xxstar: 2200ms;
  --zap-cycle-xxplus: 2400ms;
  --zap-cycle-xx: 2600ms;
  --xs-glow-scale-min: 0.9;
  --xs-glow-scale-max: 1.05;
  --xs-glow-opacity-min: 0.25;
  --xs-glow-opacity-max: 0.42;
  --xs-glow-blur: 14px;
}
/* Crackle overlay for JS-driven sparks */
.crackle-layer{
  position: absolute;
  /* ring pad outside the chip for ring sparks */
  inset: calc(var(--ring-pad, 10px) * -1);
  pointer-events: none;
  overflow: visible;
}
.crackle-layer > svg{ width: 100%; height: 100%; display: block; }
.spark{
  fill: none;
  stroke: var(--zap-color, #a78bfa);
  opacity: 0;
  stroke-linecap: round;
  stroke-linejoin: round;
  vector-effect: non-scaling-stroke;
  shape-rendering: geometricPrecision;
  transition: opacity 90ms linear;
  filter:
    drop-shadow(0 0 2px var(--zap-color, #a78bfa))
    drop-shadow(0 0 7px var(--zap-color, #a78bfa));
}
.spark.show{ opacity: 1; }

@keyframes xxPulse {
  0%, 100% {
    transform: scale(0.97);
    opacity: 0.65;
    filter: blur(1.3px);
  }
  45% {
    transform: scale(1.03);
    opacity: 0.9;
    filter: blur(1.9px);
  }
  70% {
    transform: scale(1.01);
    opacity: 0.78;
    filter: blur(1.5px);
  }
}

@keyframes xsGlowPulse {
  0%, 100% {
    transform: scale(var(--xs-glow-scale-min, 0.9));
    opacity: var(--xs-glow-opacity-min, 0.25);
  }
  50% {
    transform: scale(var(--xs-glow-scale-max, 1.05));
    opacity: var(--xs-glow-opacity-max, 0.42);
  }
}

@keyframes xxScorePulse {
  0%, 100% {
    opacity: 0.5;
    transform: scale(0.97);
    filter: blur(1.1px);
  }
  45% {
    opacity: 0.75;
    transform: scale(1.02);
    filter: blur(1.5px);
  }
  70% {
    opacity: 0.6;
    transform: scale(1.0);
    filter: blur(1.2px);
  }
}

.grade-badge.grade-tier-xsplus,
.grade-chip.grade-tier-xsplus {
  --xs-glow-scale-min: 0.93;
  --xs-glow-scale-max: 1.08;
  --xs-glow-opacity-min: 0.28;
  --xs-glow-opacity-max: 0.48;
  --xs-glow-blur: 16px;
}

.grade-badge.grade-tier-xs,
.grade-chip.grade-tier-xs {
  --xs-glow-scale-min: 0.9;
  --xs-glow-scale-max: 1.05;
  --xs-glow-opacity-min: 0.24;
  --xs-glow-opacity-max: 0.4;
  --xs-glow-blur: 14px;
}

.grade-badge.grade-tier-xsminus,
.grade-chip.grade-tier-xsminus {
  --xs-glow-scale-min: 0.88;
  --xs-glow-scale-max: 1.02;
  --xs-glow-opacity-min: 0.2;
  --xs-glow-opacity-max: 0.34;
  --xs-glow-blur: 12px;
}

.grade-badge.grade-tier-xsplus::before,
.grade-chip.grade-tier-xsplus::before,
.grade-badge.grade-tier-xs::before,
.grade-chip.grade-tier-xs::before,
.grade-badge.grade-tier-xsminus::before,
.grade-chip.grade-tier-xsminus::before {
  content: "";
  position: absolute;
  inset: -10px;
  border-radius: 999px;
  pointer-events: none;
  z-index: -1;
  background: radial-gradient(
    circle,
    rgba(167, 139, 250, 0.45) 0%,
    rgba(167, 139, 250, 0.25) 38%,
    rgba(167, 139, 250, 0) 75%
  );
  filter: blur(var(--xs-glow-blur, 14px));
  transform: scale(var(--xs-glow-scale-min, 0.9));
  opacity: var(--xs-glow-opacity-min, 0.25);
  animation: xsGlowPulse 4.8s ease-in-out infinite;
}

@media (prefers-reduced-motion: reduce){
  .crackle-layer .spark{ display: none; }
  .crackle-layer::after{
    content: "";
    position: absolute; inset: 0;
    border: 1px solid var(--zap-color, #a78bfa);
    border-radius: 999px;
    opacity: .5;
  }
  .grade-badge.grade-tier-xsplus::before,
  .grade-chip.grade-tier-xsplus::before,
  .grade-badge.grade-tier-xs::before,
  .grade-chip.grade-tier-xs::before,
  .grade-badge.grade-tier-xsminus::before,
  .grade-chip.grade-tier-xsminus::before {
    animation: none;
    opacity: var(--xs-glow-opacity-max, 0.42);
    transform: scale(1);
  }
}
